<?php
//echo '<pre>';
//print_r($data);
//echo '</pre>';
?>
<div class="container">
    <div class="row">
        <div class="col-12">

            <div class="jumbotron jumbotron-fluid">
                <div class="container">
                    <h1 class="display-4">My Hours Log</h1>
                    <p>You have: <?php echo $total; ?></p>
                    <p>You have/Assigned: <?php echo $assigned; ?> %</p>
                    <p>Assigned: <?php echo $totalHour; ?></p>
                    <p>Ты опоздал: <?php echo $lates; ?> </p>
                </div>
            </div>

            <?php echo $this->tag->form("/user/worktable"); ?>

            <div class="form-group">
                <?php echo $form->render('yearTable'); ?>
            </div>

            <div class="form-group">
                <?php echo $form->render('monthTable'); ?>
            </div>

            <div class="form-group">
                <?php echo $form->render('submit'); ?>
            </div>

            <input type='hidden' name='<?= $this->security->getTokenKey() ?>' value='<?= $this->security->getToken() ?>'/>
            </form>

            <button class="btn btn-success" onclick="hide();">Hide</button>
            <button class="btn btn-success" onclick="show();">Show</button>
            <div class="table-responsive">
                <table summary="This table shows how to create responsive tables using Bootstrap's default functionality" class="table table-bordered table-hover">

                    <thead>
                        <tr>
                            <th>день</th>
                            <?php foreach ($users as $user): ?>
                                <th><?php echo $user->name; ?></th>
                            <?php endforeach; ?>
                        </tr>
                    </thead>

                    <tbody id="mytab1">
                        <?php foreach ($data as $currentDay=>$data): ?>
                            <tr>
                               <td><?php echo $currentDay; ?> </td>

                                <?php foreach ($data as $userData): ?>
                                    <td>
                                        <?php if( $userId == $userData['id'] and $currentDay == $dayOfMonth and $userData['month'] = $monthTab ): ?>

                                            <?php if($userData['start_time'] != null and $userData['start_time'] != '' and $userData['start_time'] != 0): ?>
                                                <input type="button" class="btn btn-primary"
                                                       id="start"
                                                       data-start="stop"
                                                       onclick="checkInputTime(this);"
                                                       data-timeinfo=""
                                                       value="стоп" />
                                            <?php else: ?>
                                                <input type="button" class="btn btn-success"
                                                       id="start"
                                                       onclick="checkInputTime(this);"
                                                       data-timeinfo=""
                                                       data-start="start"
                                                       value="старт" />
                                            <?php endif; ?>

                                            <div id="startTime">
                                                <?php echo round($userData['start_time'], 2); ?>
                                            </div> -
                                            <div id="endTime">
                                                <?php echo round($userData['end_time'], 2); ?>
                                            </div>

                                            <?php else: ?>
                                            <div id="startTimeOtherDay">
                                                <?php echo round($userData['start_time'], 2); ?>
                                            </div> -
                                            <div id="endTimeOtherDay">
                                                <?php echo round($userData['end_time'], 2); ?>
                                            </div>

                                        <?php endif; ?>
                                    </td>
                                <?php endforeach ?>

                            </tr>
                        <?php endforeach; ?>
                    </tbody>
                </table>
            </div><!--end of .table-responsive-->
        </div>
    </div>
</div>
